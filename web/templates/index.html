<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RustDesk Console - Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Background gradient -->
    <div class="bg-gradient"></div>
    
    <!-- Navigation -->
    <nav class="navbar glass-effect">
        <div class="nav-content">
            <div class="nav-brand">
                <i class="fas fa-desktop"></i>
                <span>RustDesk Console</span>
            </div>
            <div class="nav-stats">
                <div class="stat-badge" id="totalDevices">
                    <i class="fas fa-server"></i>
                    <span>0</span>
                </div>
                <div class="stat-badge active" id="activeDevices">
                    <i class="fas fa-circle-check"></i>
                    <span>0</span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="container">
        <!-- Header Section -->
        <div class="header-section">
            <h1 class="page-title fade-in">Device Management</h1>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="showPublicKey()">
                    <i class="fas fa-key"></i>
                    Public Key
                </button>
                <button class="btn btn-secondary" onclick="refreshDevices()">
                    <i class="fas fa-sync-alt"></i>
                    Refresh
                </button>
            </div>
        </div>

        <!-- Stats Cards -->
        <div class="stats-grid fade-in" style="animation-delay: 0.1s;">
            <div class="stat-card glass-effect">
                <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <i class="fas fa-server"></i>
                </div>
                <div class="stat-info">
                    <div class="stat-label">Total Devices</div>
                    <div class="stat-value" id="statTotal">0</div>
                </div>
            </div>
            
            <div class="stat-card glass-effect">
                <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                    <i class="fas fa-circle-check"></i>
                </div>
                <div class="stat-info">
                    <div class="stat-label">Active</div>
                    <div class="stat-value" id="statActive">0</div>
                </div>
            </div>
            
            <div class="stat-card glass-effect">
                <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                    <i class="fas fa-circle-xmark"></i>
                </div>
                <div class="stat-info">
                    <div class="stat-label">Inactive</div>
                    <div class="stat-value" id="statInactive">0</div>
                </div>
            </div>
            
            <div class="stat-card glass-effect">
                <div class="stat-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                    <i class="fas fa-sticky-note"></i>
                </div>
                <div class="stat-info">
                    <div class="stat-label">With Notes</div>
                    <div class="stat-value" id="statNotes">0</div>
                </div>
            </div>
        </div>

        <!-- Devices Table -->
        <div class="table-container glass-effect fade-in" style="animation-delay: 0.2s;">
            <div class="table-header">
                <h2><i class="fas fa-list"></i> Devices</h2>
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchInput" placeholder="Search devices..." onkeyup="filterDevices()">
                </div>
            </div>
            
            <div class="table-wrapper">
                <table class="devices-table" id="devicesTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Note</th>
                            <th>Status</th>
                            <th>Created</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="devicesTableBody">
                        <tr>
                            <td colspan="5" class="loading">
                                <div class="spinner"></div>
                                <span>Loading devices...</span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Edit Device Modal -->
    <div id="editModal" class="modal">
        <div class="modal-content glass-effect">
            <div class="modal-header">
                <h2><i class="fas fa-edit"></i> Edit Device</h2>
                <button class="modal-close" onclick="closeEditModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="editDeviceId">Device ID</label>
                    <input type="text" id="editDeviceId" readonly class="form-control">
                </div>
                <div class="form-group">
                    <label for="editNewId">New Device ID (optional)</label>
                    <input type="text" id="editNewId" class="form-control" placeholder="Leave empty to keep current ID">
                </div>
                <div class="form-group">
                    <label for="editNote">Note</label>
                    <textarea id="editNote" class="form-control" rows="3" placeholder="Enter device note..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeEditModal()">
                    <i class="fas fa-times"></i> Cancel
                </button>
                <button class="btn btn-primary" onclick="saveDevice()">
                    <i class="fas fa-save"></i> Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="modal">
        <div class="modal-content glass-effect">
            <div class="modal-header">
                <h2><i class="fas fa-trash-alt"></i> Confirm Delete</h2>
                <button class="modal-close" onclick="closeDeleteModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete device <strong id="deleteDeviceId"></strong>?</p>
                <p class="warning-text">This action cannot be undone.</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeDeleteModal()">
                    <i class="fas fa-times"></i> Cancel
                </button>
                <button class="btn btn-danger" onclick="confirmDelete()">
                    <i class="fas fa-trash-alt"></i> Delete
                </button>
            </div>
        </div>
    </div>

    <!-- Details Modal -->
    <div id="detailsModal" class="modal">
        <div class="modal-content glass-effect modal-large">
            <div class="modal-header">
                <h2><i class="fas fa-info-circle"></i> Device Details</h2>
                <button class="modal-close" onclick="closeDetailsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="detailsContent" class="details-grid"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeDetailsModal()">
                    <i class="fas fa-times"></i> Close
                </button>
            </div>
        </div>
    </div>

    <!-- Public Key Modal -->
    <div id="keyModal" class="modal">
        <div class="modal-content glass-effect">
            <div class="modal-header">
                <h2><i class="fas fa-key"></i> RustDesk Public Key</h2>
                <button class="modal-close" onclick="closeKeyModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="key-display">
                    <code id="publicKeyDisplay">{{ public_key }}</code>
                </div>
                <button class="btn btn-primary btn-block" onclick="copyPublicKey()">
                    <i class="fas fa-copy"></i> Copy to Clipboard
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast glass-effect">
        <i class="fas fa-check-circle"></i>
        <span id="toastMessage"></span>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
